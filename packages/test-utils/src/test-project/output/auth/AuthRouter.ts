/* eslint-disable */
/**
 * This file was automatically generated by typeweaver.
 * DO NOT EDIT. Instead, modify the source definition file and generate again.
 *
 * @generated by @rexeus/typeweaver
 */

import {
  HttpMethod,
  TypeweaverRouter,
  type RequestHandler,
  type TypeweaverRouterOptions,
} from "./../lib/server";

import type { IAccessTokenRequest } from "./AccessTokenRequest";
import { AccessTokenRequestValidator } from "./AccessTokenRequestValidator";
import type { AccessTokenResponse } from "./AccessTokenResponse";

import type { IRefreshTokenRequest } from "./RefreshTokenRequest";
import { RefreshTokenRequestValidator } from "./RefreshTokenRequestValidator";
import type { RefreshTokenResponse } from "./RefreshTokenResponse";

export type ServerAuthApiHandler<TState extends Record<string, unknown> = Record<string, unknown>> =
  {
    handleAccessTokenRequest: RequestHandler<IAccessTokenRequest, AccessTokenResponse, TState>;

    handleRefreshTokenRequest: RequestHandler<IRefreshTokenRequest, RefreshTokenResponse, TState>;
  };

export class AuthRouter<
  TState extends Record<string, unknown> = Record<string, unknown>,
> extends TypeweaverRouter<ServerAuthApiHandler<TState>> {
  public constructor(options: TypeweaverRouterOptions<ServerAuthApiHandler<TState>>) {
    super(options);
    this.setupRoutes();
  }

  protected setupRoutes(): void {
    this.route(
      HttpMethod.POST,
      "/auth/access-token",
      new AccessTokenRequestValidator(),
      this.requestHandlers.handleAccessTokenRequest.bind(this.requestHandlers),
    );

    this.route(
      HttpMethod.POST,
      "/auth/refresh-token",
      new RefreshTokenRequestValidator(),
      this.requestHandlers.handleRefreshTokenRequest.bind(this.requestHandlers),
    );
  }
}
