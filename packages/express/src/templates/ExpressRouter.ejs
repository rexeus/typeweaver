/* eslint-disable */
/**
 * This file was automatically generated by typeweaver.
 * DO NOT EDIT. Instead, modify the source definition file and generate again.
 *
 * @generated by @rexeus/typeweaver
 */

import type { Request, Response, NextFunction } from "express";
import { TypeweaverExpress, type ExpressRequestHandler, type TypeweaverExpressOptions } from "<%- coreDir %>/lib/express";
<% for (const operation of operations) { %>
import type { I<%- operation.className %>Request } from "./<%- operation.className %>Request";
import { <%- operation.className %>RequestValidator } from "./<%- operation.className %>RequestValidator";
import type { <%- operation.className %>Response } from "./<%- operation.className %>Response";
<% } %>

export type <%- pascalCaseEntityName %>ExpressApiHandler = {
<% for (const operation of operations) { %>
  readonly <%- operation.handlerName %>: ExpressRequestHandler<I<%- operation.className %>Request, <%- operation.className %>Response>;
<% } %>
};

export class <%- pascalCaseEntityName %>Express extends TypeweaverExpress<<%- pascalCaseEntityName %>ExpressApiHandler> {
  public constructor(options: TypeweaverExpressOptions<<%- pascalCaseEntityName %>ExpressApiHandler>) {
    super(options);
  }

  protected override setupRoutes(): void {
<% for (const operation of operations) { %>
    this.router.<%- operation.method.toLowerCase() %>('<%- operation.path %>', async (req: Request, res: Response, next: NextFunction) =>
      this.handleRequest(
        req,
        res,
        next,
        new <%- operation.className %>RequestValidator(),
        this.requestHandlers.<%- operation.handlerName %>.bind(this.requestHandlers)
      ));

<% } %>
  }
}
