/* eslint-disable */
/**
 * This file was automatically generated by typeweaver.
 * DO NOT EDIT. Instead, modify the source definition file and generate again.
 *
 * @generated by @rexeus/typeweaver
 */

import { HttpMethod, TypeweaverRouter, type RequestHandler, type TypeweaverRouterOptions } from "<%- coreDir %>/lib/server";
<% for (const operation of operations) { %>
import type { I<%- operation.className %>Request } from "./<%- operation.className %>Request";
import { <%- operation.className %>RequestValidator } from "./<%- operation.className %>RequestValidator";
import type { <%- operation.className %>Response } from "./<%- operation.className %>Response";
<% } %>

export type Server<%- pascalCaseEntityName %>ApiHandler<
  TState extends Record<string, unknown> = Record<string, unknown>,
> = {
<% for (const operation of operations) { %>
  <%- operation.handlerName %>: RequestHandler<I<%- operation.className %>Request, <%- operation.className %>Response, TState>;
<% } %>
};

export class <%- pascalCaseEntityName %>Router<
  TState extends Record<string, unknown> = Record<string, unknown>,
> extends TypeweaverRouter<Server<%- pascalCaseEntityName %>ApiHandler<TState>> {
  public constructor(options: TypeweaverRouterOptions<Server<%- pascalCaseEntityName %>ApiHandler<TState>>) {
    super(options);
    this.setupRoutes();
  }

  protected setupRoutes(): void {
<% for (const operation of operations) { %>
    this.route(
      HttpMethod.<%- operation.method %>,
      '<%- operation.path %>',
      new <%- operation.className %>RequestValidator(),
      this.requestHandlers.<%- operation.handlerName %>.bind(this.requestHandlers)
    );

<% } %>
  }
}
